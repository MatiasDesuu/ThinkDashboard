<!DOCTYPE html>
<html lang="en" data-theme="{{.Theme}}" data-font-size="{{.FontSize}}" data-show-background-dots="{{.ShowBackgroundDots}}" data-enable-custom-font="{{.EnableCustomFont}}" data-custom-font-path="{{.CustomFontPath}}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Configuration</title>
    <script src="/static/js/theme-loader.js"></script>
    <link rel="icon" type="image/x-icon" href="{{if and .EnableCustomFavicon .CustomFaviconPath}}{{.CustomFaviconPath}}{{else}}/static/favicon.ico{{end}}">
    <link rel="stylesheet" href="/api/theme.css">
    <link rel="stylesheet" href="/static/css/theme.css">
    <link rel="stylesheet" href="/static/css/config.css">
    <link rel="stylesheet" href="/static/css/reorder.css">
    <link rel="stylesheet" href="/static/css/modal.css">
    <link rel="stylesheet" href="/static/css/search.css">
    <link rel="stylesheet" href="/static/css/status.css">
    <link rel="stylesheet" href="/static/css/select.css">
    <link rel="stylesheet" href="/static/css/font-size.css">
    <link rel="stylesheet" href="/static/css/responsive.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;900&display=swap" rel="stylesheet">
    <style>
        /* Prevent flash of unstyled content */
        body.loading {
            opacity: 0;
            visibility: hidden;
        }
    </style>
</head>
<body class="{{.Theme}} font-size-{{.FontSize}} loading" data-theme="{{.Theme}}" data-show-background-dots="{{.ShowBackgroundDots}}">
    <!-- Contenedor 1: Title y nav links -->
    <div class="config-section section-header">
        <div class="container">
            <header class="header">
                <h1 class="title" data-i18n="config.title">configuration</h1>
                <div class="nav-links">
                    <a href="/colors" class="back-link" data-i18n="config.customizeColors">→ customize colors</a>
                    <a href="/" class="back-link" data-i18n="config.backToDashboard">← back to dashboard</a>
                </div>
            </header>
        </div>
    </div>

    <!-- Contenedor 2: Save/Reset buttons y tabs -->
    <div class="config-section section-controls">
        <div class="container">
            <div class="config-controls-wrapper">
                <div class="config-actions-top">
                    <button id="save-btn" class="btn btn-success" data-i18n="config.saveChanges">Save Changes</button>
                    <button id="reset-btn" class="btn btn-danger" data-i18n="config.resetToDefaults">Reset to Defaults</button>
                </div>

                <div class="tabs">
                    <button class="tab-button active" data-tab="general" data-i18n="config.generalTab">general</button>
                    <button class="tab-button" data-tab="pages" data-i18n="config.pagesTab">pages</button>
                    <button class="tab-button" data-tab="categories" data-i18n="config.categoriesTab">categories</button>
                    <button class="tab-button" data-tab="bookmarks" data-i18n="config.bookmarksTab">bookmarks</button>
                    <button class="tab-button" data-tab="backups" data-i18n="config.backupsTab">backups</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenedor 3: Contenido de la página -->
    <div class="config-section section-content">
        <div class="container">
            <main class="config-main">
            <div class="tab-content active" data-tab-content="general">
            <div class="config-section">
                <div class="form-group">
                    <label for="theme-select" data-i18n="config.themeLabel">Theme:</label>
                    <select id="theme-select">
                        <option value="dark" data-i18n="dashboard.darkTheme">Dark</option>
                        <option value="light" data-i18n="dashboard.lightTheme">Light</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="language-select" data-i18n="config.languageLabel">Language:</label>
                    <select id="language-select">
                        <option value="en">English</option>
                        <option value="es">Español</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="columns-input">Columns per row:</label>
                    <div class="number-input-wrapper">
                        <input type="number" id="columns-input" min="1" max="6" value="3">
                        <div class="number-input-controls">
                            <button type="button" class="number-input-btn number-input-up" data-input="columns-input">▲</button>
                            <button type="button" class="number-input-btn number-input-down" data-input="columns-input">▼</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label data-i18n="config.fontSizeLabel">Font size:</label>
                    <div class="font-size-selector">
                        <button type="button" class="font-size-option" data-size="xs">xs</button>
                        <button type="button" class="font-size-option" data-size="s">s</button>
                        <button type="button" class="font-size-option" data-size="sm">sm</button>
                        <button type="button" class="font-size-option active" data-size="m">m</button>
                        <button type="button" class="font-size-option" data-size="lg">lg</button>
                        <button type="button" class="font-size-option" data-size="l">l</button>
                        <button type="button" class="font-size-option" data-size="xl">xl</button>
                    </div>
                </div>
                
                <div class="checkbox-tree">
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="new-tab-checkbox">
                            <span class="checkbox-text" data-i18n="config.openLinksInNewTab">Open links in new tab</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="hypr-mode-checkbox">
                            <span class="checkbox-text" data-i18n="config.hyprMode">HyprMode (Launcher mode for PWA)</span>
                            <button type="button" id="hypr-mode-info-btn" class="info-button">ℹ</button>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-background-dots-checkbox">
                            <span class="checkbox-text" data-i18n="config.showBackgroundDots">Show background dots</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-title-checkbox">
                            <span class="checkbox-text" data-i18n="config.showDashboardTitle">Show dashboard title</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-custom-title-checkbox">
                            <span class="checkbox-text" data-i18n="config.enableCustomTitle">Enable custom title</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item checkbox-tree-child">
                        <span class="tree-symbol">└──</span>
                        <label for="custom-title-input" data-i18n="config.customTitleLabel">Custom title:</label>
                        <input type="text" id="custom-title-input" data-i18n-placeholder="config.customTitlePlaceholder" placeholder="Enter custom title">
                    </div>
                    <div class="checkbox-tree-item checkbox-tree-child">
                        <span class="tree-symbol">└──</span>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-page-in-title-checkbox">
                            <span class="checkbox-text" data-i18n="config.showPageInTitle">Show page name in title</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="interleave-mode-checkbox">
                            <span class="checkbox-text" data-i18n="config.interleaveMode">Switch Search Mode</span>
                            <button type="button" id="interleave-mode-info-btn" class="info-button">ℹ</button>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-config-button-checkbox">
                            <span class="checkbox-text" data-i18n="config.showConfigButton">Show config button</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-page-names-in-tabs-checkbox">
                            <span class="checkbox-text" data-i18n="config.showPageNamesInTabs">Show page names in tabs</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-custom-favicon-checkbox">
                            <span class="checkbox-text" data-i18n="config.enableCustomFavicon">Enable custom favicon</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item checkbox-tree-child">
                        <span class="tree-symbol">└──</span>
                        <label for="custom-favicon-input" data-i18n="config.uploadFaviconLabel">Upload favicon:</label>
                        <label for="custom-favicon-input" class="btn btn-secondary file-input-btn">Choose File</label>
                        <input type="file" id="custom-favicon-input" accept="image/x-icon,image/png,image/jpeg,image/gif" style="display: none;">
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-custom-font-checkbox">
                            <span class="checkbox-text">Enable custom font</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item checkbox-tree-child">
                        <span class="tree-symbol">└──</span>
                        <label for="custom-font-input">Upload font:</label>
                        <label for="custom-font-input" class="btn btn-secondary file-input-btn">Choose File</label>
                        <input type="file" id="custom-font-input" accept=".woff,.woff2,.ttf,.otf" style="display: none;">
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-search-button-checkbox">
                            <span class="checkbox-text" data-i18n="config.showSearchButton">Show search button</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="animations-enabled-checkbox">
                            <span class="checkbox-text" data-i18n="config.enableAnimations">Enable animations</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="device-specific-checkbox">
                            <span class="checkbox-text" data-i18n="config.deviceSpecificSettings">Use device-specific settings</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="global-shortcuts-checkbox">
                            <span class="checkbox-text" data-i18n="config.globalShortcuts">Use shortcuts from all pages</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-status-checkbox">
                            <span class="checkbox-text" data-i18n="config.showBookmarkStatus">Show bookmark status (online/offline)</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item checkbox-tree-child">
                        <span class="tree-symbol">└──</span>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-ping-checkbox">
                            <span class="checkbox-text" data-i18n="config.showPingTimes">Show ping times (ms)</span>
                        </label>
                    </div>
                    <div class="checkbox-tree-item checkbox-tree-child">
                        <span class="tree-symbol">└──</span>
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-status-loading-checkbox">
                            <span class="checkbox-text" data-i18n="config.showStatusLoading">Show status loading indicator</span>
                        </label>
                    </div>
                </div>
            </div>
            </div>

            <div class="tab-content" data-tab-content="pages">
            <div class="config-section">
                <div id="pages-list" class="pages-list js-list">
                    <!-- Pages will be loaded here -->
                </div>
                <button id="add-page-btn" class="btn btn-primary" data-i18n="config.addPage">Add Page</button>
            </div>
            </div>

            <div class="tab-content" data-tab-content="categories">
            <div class="config-section">
                <div class="page-selector-wrapper">
                    <label for="categories-page-selector" data-i18n="config.categoriesPageLabel">Categories page:</label>
                    <select id="categories-page-selector" class="page-selector">
                        <!-- Pages will be loaded here -->
                    </select>
                </div>
                <div id="categories-list" class="categories-list js-list">
                    <!-- Categories will be loaded here -->
                </div>
                <button id="add-category-btn" class="btn btn-primary" data-i18n="config.addCategory">Add Category</button>
            </div>
            </div>

            <div class="tab-content" data-tab-content="bookmarks">
            <div class="config-section">
                <div class="page-selector-wrapper">
                    <label for="page-selector" data-i18n="config.bookmarksPageLabel">Bookmarks page:</label>
                    <select id="page-selector" class="page-selector">
                        <!-- Pages will be loaded here -->
                    </select>
                </div>
                <div id="bookmarks-list" class="bookmarks-list js-list">
                    <!-- Bookmarks will be loaded here -->
                </div>
                <button id="add-bookmark-btn" class="btn btn-primary" data-i18n="config.addBookmark">Add Bookmark</button>
            </div>
            </div>

            <div class="tab-content" data-tab-content="backups">
            <div class="config-section">
                <div class="form-group">
                    <label data-i18n="config.backupDescription">Export your data</label>
                    <button type="button" id="backup-info-btn" class="info-button">ℹ</button>
                    <button id="backup-btn" class="btn btn-primary" data-i18n="config.createBackup">Create Backup</button>
                </div>
                <div class="form-group">
                    <label data-i18n="config.importDescription">Import your data</label>
                    <button type="button" id="import-info-btn" class="info-button">ℹ</button>
                    <input type="file" id="import-file" accept=".zip" style="display: none;">
                    <button id="import-btn" class="btn btn-danger" data-i18n="config.selectImportFile">Select Import File</button>
                </div>
            </div>
            </div>

            </main>
        </div>
    </div>

    <div id="notification" class="notification">
        <span id="notification-message"></span>
    </div>

    <script src="/static/js/modal.js"></script>
    <script src="/static/js/status.js"></script>
    <script src="/static/js/select.js"></script>
    <script src="/static/js/reorder.js"></script>
    <script src="/static/js/hypr-mode.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- Config modules (must be loaded before main config.js) -->
    <script src="/static/js/config/config-ui.js"></script>
    <script src="/static/js/config/config-storage.js"></script>
    <script src="/static/js/config/config-data.js"></script>
    <script src="/static/js/config/config-pages.js"></script>
    <script src="/static/js/config/config-categories.js"></script>
    <script src="/static/js/config/config-bookmarks.js"></script>
    <script src="/static/js/config/config-backup.js"></script>
    <script src="/static/js/config/config-font.js"></script>
    <script src="/static/js/config/config-settings.js"></script>
    <script src="/static/js/config/config-language.js"></script>
    <!-- Main config orchestrator -->
    <script src="/static/js/config.js"></script>
    <!-- Keyboard shortcuts -->
    <script src="/static/js/config-keyboard.js"></script>
</body>
</html>